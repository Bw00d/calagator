<%
opts ||= {}
previous_start_time = nil
if local_assigns.has_key?(:leaf)
  events  ||= leaf[:results]
  skipped ||= leaf[:skipped]
else
  skipped ||= 0
end
show_year ||= true

%>
<ul class='event_list'>
	<% unless events.size==0 %>
    	<% for event in events do %>
	      	<% new_day = previous_start_time.nil? || previous_start_time && previous_start_time.to_date != event.start_time.to_date %>
			<%= render :partial => 'events/list_item', :locals => { :event => event, :new_day => new_day, :opts => opts, :show_year => show_year } %>
			<% previous_start_time = event.start_time %>
		<% end %>
	<% else %>
		<li class='blank_list'>
			No events.
		</li>
	<% end %>
  <% if skipped > 0 %>
    <li>
      <%= link_to "(And #{skipped} more)", events_url %>
    </li>
  <% end %>
</ul>
